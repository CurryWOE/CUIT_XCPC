# 二进制浮点数算术标准(IEEE754)
$V=(-1)^s\times M\times 2^E$

符号(sign)，s决定这数是负数(s=1)还是正数(s=0)，特别的，数值0的符号位解释作为特殊情况处理

尾数(significand)，M是一个二进制小数，范围是1~2-$\epsilon$，或0~1-$\epsilon$

阶码(exponent)，E对浮点数加权，权重是2的E次幂(可能是负数)

32位浮点数=1bit符号，8bit阶码，23bit尾数

64位浮点数=1bit符号，11bit阶码，52bit尾数

根据阶码和尾数，一个位表示可以分成4种情况解释

1. 阶码非全0非全1，规格化的
2. 阶码全0，非规格化的
3. 阶码全1，尾数全0，无穷大
4. 阶码全1，尾数非全0，NaN(Not a Number)
## 规格化的
E=e-Bias，e是阶码的位表示，E是实际要表示的意思

Bias=$2^{k-1}-1$，k是阶码的位数，32位Bias是127，64位Bias是1023

32位E的范围是[-126,127]，64位E的范围是[-1022,1023]

M=1+f，f是尾数的位表示，M是实际要表示的意思

规格化的数不能表示数值0或非常接近0的数

规格化的数不是均匀分布
## 非规格化的
E=1-Bias

M=f

非规格化的数可以表示数值0

非规格化的数可以表示非常接近0的数，数值分布均匀地接近于0.0
## 常用数
32位相邻数最小差是 $2^{1-127}*2^{-23}=2^{-149}\approx 1.401 \times 10^{-45}$

32位相邻数最大差是 $2^{127}*2^{-23}=2^{104}\approx 2.028 \times 10^{31}$

32位比1大的第一个数与1的差值 $2^{-23}\approx 1.192\times 10^{-7}$

32位最大数是 $2^{127}*(2-2^{-23})=2^{128}-2^{104}\approx 3.403 \times 10^{33}$

64位相邻数最小差是 $2^{1-1023}*2^{-52}=2^{-1074}\approx 4.941 \times 10^{-324}$

64位相邻数最大差是 $2^{1023}*2^{-52}=2^{971}\approx 1.996 \times 10^{292}$

64位比1大的第一个数与1的差值 $2^{-52}\approx 2.220\times 10^{-16}$

64位最大数是 $2^{1023}*(2-2^{-52})=2^{1024}-2^{971}\approx 1.798 \times 10^{308}$
# 竞争性编程中的误差
假设正确答案为 answer，选手的计算结果为 result，误差为Error(以下简称E)

绝对误差 $E_{absolute}=|answer-result|$

相对误差 $E_{relative}=|\frac{answer-result}{answer}|$

当数值远大于1时，因为相邻数差值大，所以绝对误差过大

当数值远小于1时，虽然分布均匀且差值小，绝对误差和相对误差都比较小，但是大数字和小数字做加减法会因为对阶丢失精度

1是平衡点，所以尽量在1附近计算，同时分析误差也是按照1附近来分析
## 运算导致的误差传递公式
设变量x,y的绝对误差为 $\Delta x$,$\Delta y$
### 加法x+y
$\Delta E_{absolute}=\Delta x + \Delta y$

$\Delta E_{relative}=|\frac{\Delta x + \Delta y}{x + y}|$
### 减法x-y
$\Delta E_{absolute}=\Delta x + \Delta y$

$\Delta E_{relative}=|\frac{\Delta x + \Delta y}{x - y}|$
### 乘法xy
$\Delta E_{absolute}=|y|\Delta x + |x|\Delta y$

$\Delta E_{relative}=|\frac{|y|\Delta x + |x|\Delta y}{xy}|$
### 除法x/y
$\Delta E_{absolute}=\frac{|y|\Delta x + |x|\Delta y}{y^2}$

$\Delta E_{relative}=|\frac{\Delta x}{x}|+|\frac{\Delta y}{y}|$
### 幂x^y
$\Delta E_{absolute}=|x+\Delta x|^y-|x|^y$

$\Delta E_{relative}=|\frac{x+\Delta x}{x}|^y-1$
### 指数e^x
$\Delta E_{absolute}=e^x(e^{\Delta x}-1)$

$\Delta E_{relative}=e^{\Delta x}-1$
### 对数ln(x)
$\Delta E_{absolute}=\ln(1+\frac{\Delta x}{|x|})$

$\Delta E_{relative}=\frac{\ln(1+\frac{\Delta x}{|x|})}{|\ln x|}$