$\int_{l_1}^{r_1}\int_{l_2}^{r_2}|x-y|dxdy,l_1<l_2<r_1<r_2$

$\begin{aligned}\int_{l_1}^{r_1}\int_{l_2}^{r_2}|x-y|dxdy&=\int_{l_2}^{r_1}\int_{l_2}^{x}(x-y)dxdy+\int_{l_1}^{r_1}\int_{max(x,l_2)}^{r_2}(y-x)dxdy\\&=\int_{l_2}^{r_1}[xy-\frac 12y^2]_{l_2}^xdx+\int_{l_1}^{l_2}[\frac 12y^2-xy]_{l_2}^{r_2}dx+\int_{l_2}^{r_1}[\frac 12y^2-xy]_x^{r_2}dx\\&=\int_{l_2}^{r_1}[\frac 12x^2-l_2x+\frac 12l_2^2]dx+\int_{l_1}^{l_2}[\frac 12(r_2^2-l_2^2)-x(r_2-l_2)]dx+\int_{l_2}^{r_1}[\frac 12x^2-r_2x+\frac 12r_2^2]dx\\&=[\frac 16x^3-\frac 12l_2x^2+\frac 12l_2^2x]_{l_2}^{r_1}+[\frac 12(r_2^2-l_2^2)x-\frac 12x^2(r_2-l_2)]_{l_1}^{l_2}+[\frac 16x^3-\frac 12r_2x^2+\frac 12r_2^2x]_{l_2}^{r_1}\\&=[\frac 16(r_1^3-l_2^3)-\frac 12l_2(r_1^2-l_2^2)+\frac 12l_2^2(r_1-l_2)]+[\frac 12(r_2^2-l_2^2)(l_2-l_1)-\frac 12(l_2^2-l_1^2)(r_2-l_2)]+[\frac 16(r_1^3-l_2^3)-\frac 12r_2(r_1^2-l_2^2)+\frac 12r_2^2(r_1-l_2)]\\&=\frac 13(r_1^3-l_2^3)-\frac 12r_1^2(l_2+r_2)+\frac 12r_1(l_2^2+r_2^2)+l_1^2(r_2-l_2)-\frac 12l_1(r_2^2-l_2^2)\end{aligned}$