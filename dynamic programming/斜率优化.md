# 斜率优化
考虑DP转移形如 $ans_i=\min\limits_{j<i}f'(j)+f''(i)+f'''(i,j)$

其中 $f'(j)$ 表示只与 j 有关的信息，$f''(i)$ 表示只与 i 有关的信息，$f'''(i,j)$ 表示同时与 i,j 有关的信息

令 $b=ans_i-f''(i),y=f'(j),kx=f'''(i,j)$

根据具体题目将 f'''(i,j) 转换为 $f'''(i,j)=f''''(i)f'''''(j)$

令 $k=-f''''(i),x=f'''''(j)$

重写转移方程 $b_i=\min\limits_{j<i}y_j-k_ix_j$

把 $(x_j,y_j)$ 视为二维平面上的点，考虑一条过 $(x_j,y_j)$ 直线 

其他数都是已知，只有 $ans_i$ 未知，当 $b_i$ 最小时 $ans_i$ 也取得最小，所以从小到大考虑 $b_i$ 的合法性

当逐渐增大 $b_i$，直线逐渐上移，直线第一次穿过某个点 $(x_j,y_j)$ ，该点一定在全部点的下凸壳

维护下凸壳，令倒数第一个候选决策点为 $opt_{last}$，倒数第二个候选决策点为 $opt_{last-1}$，当前要加入点集的点为 $cur$，且 $x_{cur}>x_{opt_{last}}>x_{opt_{last-1}}$

如果三点叉积 $(x_{opt_{last}}-x_{opt_{last-1}})*(y_{cur}-y_{opt_{last}})-(y_{opt_{last}}-y_{opt_{last-1}})*(x_{cur}-x_{opt_{last}})\le 0$

那么 $opt_{last}$ 不再是凸包，踢出队列

最优决策点(是 $x_j$ 不是 $j$ )单调性和 $k_i$ 单调性一致（结合函数图像理解）

---
DP转移如果是max，最优转移点在上凸壳，最优决策点(是 $x_j$ 不是 $j$ )单调性和 $k_i$ 单调性相反

具体做法：

0. 用数组模拟std::deque
1. index单调递增来找到最优决策点(答案表达式到达极小值，同时也是最小值)
2. 计算答案
3. 维护下凸壳
4. 加入该点到队尾